#tag WindowBegin Window Window1   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   300   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   146508800   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Untitled"   Visible         =   True   Width           =   300   Begin PushButton PushButton1      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Compress File"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   82      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   188      Underline       =   ""      Visible         =   True      Width           =   136   End   Begin PushButton PushButton2      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Decompress File"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   82      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   223      Underline       =   ""      Visible         =   True      Width           =   136   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  self.Title = "zlib" + zlibModule.Version		End Sub	#tag EndEvent	#tag MenuHandler		Function Untitled() As Boolean Handles Untitled.Action					End Function	#tag EndMenuHandler	#tag Constant, Name = zlibPath, Type = String, Dynamic = False, Default = \"", Scope = Private		#Tag Instance, Platform = Mac OS, Language = Default, Definition  = \"/usr/lib/libz.dylib"		#Tag Instance, Platform = Windows, Language = Default, Definition  = \"ZLIB1.DLL"		#Tag Instance, Platform = Linux, Language = Default, Definition  = \"/usr/lib/libz.so.1"	#tag EndConstant#tag EndWindowCode#tag Events PushButton1	#tag Event		Sub Action()		  dim dlg as new OpenDialog		  if dlg.ShowModal is nil then		    return		  end if		  		  dim save as new SaveAsDialog		  save.SuggestedFileName = dlg.Result.Name + ".gz"		  save.InitialDirectory = dlg.Result.Parent		  if save.ShowModal is nil then		    return		  end if		  		  dim inStream as BinaryStream = dlg.Result.OpenAsBinaryFile		  if inStream is nil then		    dim errorMsg as new MessageDialog		    errorMsg.Message = "Unable to open file '" + dlg.Result.Name + "."		    errorMsg.Explanation = "Error " + Str(dlg.Result.LastErrorCode)		    call errorMsg.ShowModal		    return		  end if		  		  dim g as gzipStream = gzipStream.Create(save.Result)		  		  g.Write inStream.Read(inStream.Length)		  		  		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton2	#tag Event		Sub Action()		  dim dlg as new OpenDialog		  if dlg.ShowModal is nil then		    return		  end if		  		  dim save as new SaveAsDialog		  save.SuggestedFileName = ReplaceAll(dlg.Result.Name, ".gz", "")		  save.InitialDirectory = dlg.Result.Parent		  if save.ShowModal is nil then		    return		  end if		  		  		  dim b as GZipStream = GZipStream.Open(dlg.Result)		  		  dim bs_out as BinaryStream = BinaryStream.Create(save.Result)		  		  do until b.EOF		    bs_out.Write b.Read(16384)		  loop		  		  		exception oops as gzipException		  break		End Sub	#tag EndEvent#tag EndEvents